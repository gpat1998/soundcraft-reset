"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const Yt=require("isomorphic-ws");var me=function(n,e){return me=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])},me(n,e)};function R(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");me(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var ye=function(){return ye=Object.assign||function(e){for(var t,r=1,s=arguments.length;r<s;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},ye.apply(this,arguments)};function Ht(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(h){try{u(r.next(h))}catch(l){o(l)}}function c(h){try{u(r.throw(h))}catch(l){o(l)}}function u(h){h.done?i(h.value):s(h.value).then(a,c)}u((r=r.apply(n,e||[])).next())})}function Qe(n,e){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(u){return function(h){return c([u,h])}}function c(u){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(t=0)),t;)try{if(r=1,s&&(i=u[0]&2?s.return:u[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,u[1])).done)return i;switch(s=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,s=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){t.label=u[1];break}if(u[0]===6&&t.label<i[1]){t.label=i[1],i=u;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(u);break}i[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(n,t)}catch(h){u=[6,h],s=0}finally{r=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function G(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function P(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),s,i=[],o;try{for(;(e===void 0||e-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(a){o={error:a}}finally{try{s&&!s.done&&(t=r.return)&&t.call(r)}finally{if(o)throw o.error}}return i}function O(n,e,t){if(t||arguments.length===2)for(var r=0,s=e.length,i;r<s;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return n.concat(i||Array.prototype.slice.call(e))}function V(n){return this instanceof V?(this.v=n,this):new V(n)}function qt(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),s,i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(f){r[f]&&(s[f]=function(p){return new Promise(function(g,d){i.push([f,p,g,d])>1||a(f,p)})})}function a(f,p){try{c(r[f](p))}catch(g){l(i[0][3],g)}}function c(f){f.value instanceof V?Promise.resolve(f.value.v).then(u,h):l(i[0][2],f)}function u(f){a("next",f)}function h(f){a("throw",f)}function l(f,p){f(p),i.shift(),i.length&&a(i[0][0],i[0][1])}}function Jt(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof G=="function"?G(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(i){t[i]=n[i]&&function(o){return new Promise(function(a,c){o=n[i](o),s(a,c,o.done,o.value)})}}function s(i,o,a,c){Promise.resolve(c).then(function(u){i({value:u,done:a})},o)}}function $(n){return typeof n=="function"}function Me(n){var e=function(r){Error.call(r),r.stack=new Error().stack},t=n(e);return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var fe=Me(function(n){return function(t){n(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(r,s){return s+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t}});function ie(n,e){if(n){var t=n.indexOf(e);0<=t&&n.splice(t,1)}}var z=function(){function n(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return n.prototype.unsubscribe=function(){var e,t,r,s,i;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var a=G(o),c=a.next();!c.done;c=a.next()){var u=c.value;u.remove(this)}}catch(d){e={error:d}}finally{try{c&&!c.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}else o.remove(this);var h=this.initialTeardown;if($(h))try{h()}catch(d){i=d instanceof fe?d.errors:[d]}var l=this._finalizers;if(l){this._finalizers=null;try{for(var f=G(l),p=f.next();!p.done;p=f.next()){var g=p.value;try{Ge(g)}catch(d){i=i??[],d instanceof fe?i=O(O([],P(i)),P(d.errors)):i.push(d)}}}catch(d){r={error:d}}finally{try{p&&!p.done&&(s=f.return)&&s.call(f)}finally{if(r)throw r.error}}}if(i)throw new fe(i)}},n.prototype.add=function(e){var t;if(e&&e!==this)if(this.closed)Ge(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}},n.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},n.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},n.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&ie(t,e)},n.prototype.remove=function(e){var t=this._finalizers;t&&ie(t,e),e instanceof n&&e._removeParent(this)},n.EMPTY=function(){var e=new n;return e.closed=!0,e}(),n}(),et=z.EMPTY;function tt(n){return n instanceof z||n&&"closed"in n&&$(n.remove)&&$(n.add)&&$(n.unsubscribe)}function Ge(n){$(n)?n():n.unsubscribe()}var nt={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},be={setTimeout:function(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];var s=be.delegate;return s!=null&&s.setTimeout?s.setTimeout.apply(s,O([n,e],P(t))):setTimeout.apply(void 0,O([n,e],P(t)))},clearTimeout:function(n){var e=be.delegate;return((e==null?void 0:e.clearTimeout)||clearTimeout)(n)},delegate:void 0};function rt(n){be.setTimeout(function(){throw n})}function X(){}function ne(n){n()}var ae=function(n){R(e,n);function e(t){var r=n.call(this)||this;return r.isStopped=!1,t?(r.destination=t,tt(t)&&t.add(r)):r.destination=en,r}return e.create=function(t,r,s){return new N(t,r,s)},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,n.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(z),Xt=Function.prototype.bind;function de(n,e){return Xt.call(n,e)}var Zt=function(){function n(e){this.partialObserver=e}return n.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(r){te(r)}},n.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(r){te(r)}else te(e)},n.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(t){te(t)}},n}(),N=function(n){R(e,n);function e(t,r,s){var i=n.call(this)||this,o;if($(t)||!t)o={next:t??void 0,error:r??void 0,complete:s??void 0};else{var a;i&&nt.useDeprecatedNextContext?(a=Object.create(t),a.unsubscribe=function(){return i.unsubscribe()},o={next:t.next&&de(t.next,a),error:t.error&&de(t.error,a),complete:t.complete&&de(t.complete,a)}):o=t}return i.destination=new Zt(o),i}return e}(ae);function te(n){rt(n)}function Qt(n){throw n}var en={closed:!0,next:X,error:Qt,complete:X},_e=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function B(n){return n}function tn(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return st(n)}function st(n){return n.length===0?B:n.length===1?n[0]:function(t){return n.reduce(function(r,s){return s(r)},t)}}var w=function(){function n(e){e&&(this._subscribe=e)}return n.prototype.lift=function(e){var t=new n;return t.source=this,t.operator=e,t},n.prototype.subscribe=function(e,t,r){var s=this,i=rn(e)?e:new N(e,t,r);return ne(function(){var o=s,a=o.operator,c=o.source;i.add(a?a.call(i,c):c?s._subscribe(i):s._trySubscribe(i))}),i},n.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},n.prototype.forEach=function(e,t){var r=this;return t=Ne(t),new t(function(s,i){var o=new N({next:function(a){try{e(a)}catch(c){i(c),o.unsubscribe()}},error:i,complete:s});r.subscribe(o)})},n.prototype._subscribe=function(e){var t;return(t=this.source)===null||t===void 0?void 0:t.subscribe(e)},n.prototype[_e]=function(){return this},n.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return st(e)(this)},n.prototype.toPromise=function(e){var t=this;return e=Ne(e),new e(function(r,s){var i;t.subscribe(function(o){return i=o},function(o){return s(o)},function(){return r(i)})})},n.create=function(e){return new n(e)},n}();function Ne(n){var e;return(e=n??nt.Promise)!==null&&e!==void 0?e:Promise}function nn(n){return n&&$(n.next)&&$(n.error)&&$(n.complete)}function rn(n){return n&&n instanceof ae||nn(n)&&tt(n)}function sn(n){return $(n==null?void 0:n.lift)}function _(n){return function(e){if(sn(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function x(n,e,t,r,s){return new on(n,e,t,r,s)}var on=function(n){R(e,n);function e(t,r,s,i,o,a){var c=n.call(this,t)||this;return c.onFinalize=o,c.shouldUnsubscribe=a,c._next=r?function(u){try{r(u)}catch(h){t.error(h)}}:n.prototype._next,c._error=i?function(u){try{i(u)}catch(h){t.error(h)}finally{this.unsubscribe()}}:n.prototype._error,c._complete=s?function(){try{s()}catch(u){t.error(u)}finally{this.unsubscribe()}}:n.prototype._complete,c}return e.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;n.prototype.unsubscribe.call(this),!r&&((t=this.onFinalize)===null||t===void 0||t.call(this))}},e}(ae),an=Me(function(n){return function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),E=function(n){R(e,n);function e(){var t=n.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return e.prototype.lift=function(t){var r=new ge(this,this);return r.operator=t,r},e.prototype._throwIfClosed=function(){if(this.closed)throw new an},e.prototype.next=function(t){var r=this;ne(function(){var s,i;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var o=G(r.currentObservers),a=o.next();!a.done;a=o.next()){var c=a.value;c.next(t)}}catch(u){s={error:u}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(s)throw s.error}}}})},e.prototype.error=function(t){var r=this;ne(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=t;for(var s=r.observers;s.length;)s.shift().error(t)}})},e.prototype.complete=function(){var t=this;ne(function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var r=t.observers;r.length;)r.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(t){return this._throwIfClosed(),n.prototype._trySubscribe.call(this,t)},e.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},e.prototype._innerSubscribe=function(t){var r=this,s=this,i=s.hasError,o=s.isStopped,a=s.observers;return i||o?et:(this.currentObservers=null,a.push(t),new z(function(){r.currentObservers=null,ie(a,t)}))},e.prototype._checkFinalizedStatuses=function(t){var r=this,s=r.hasError,i=r.thrownError,o=r.isStopped;s?t.error(i):o&&t.complete()},e.prototype.asObservable=function(){var t=new w;return t.source=this,t},e.create=function(t,r){return new ge(t,r)},e}(w),ge=function(n){R(e,n);function e(t,r){var s=n.call(this)||this;return s.destination=t,s.source=r,s}return e.prototype.next=function(t){var r,s;(s=(r=this.destination)===null||r===void 0?void 0:r.next)===null||s===void 0||s.call(r,t)},e.prototype.error=function(t){var r,s;(s=(r=this.destination)===null||r===void 0?void 0:r.error)===null||s===void 0||s.call(r,t)},e.prototype.complete=function(){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||r===void 0||r.call(t)},e.prototype._subscribe=function(t){var r,s;return(s=(r=this.source)===null||r===void 0?void 0:r.subscribe(t))!==null&&s!==void 0?s:et},e}(E),Ce={now:function(){return(Ce.delegate||Date).now()},delegate:void 0},re=function(n){R(e,n);function e(t,r,s){t===void 0&&(t=1/0),r===void 0&&(r=1/0),s===void 0&&(s=Ce);var i=n.call(this)||this;return i._bufferSize=t,i._windowTime=r,i._timestampProvider=s,i._buffer=[],i._infiniteTimeWindow=!0,i._infiniteTimeWindow=r===1/0,i._bufferSize=Math.max(1,t),i._windowTime=Math.max(1,r),i}return e.prototype.next=function(t){var r=this,s=r.isStopped,i=r._buffer,o=r._infiniteTimeWindow,a=r._timestampProvider,c=r._windowTime;s||(i.push(t),!o&&i.push(a.now()+c)),this._trimBuffer(),n.prototype.next.call(this,t)},e.prototype._subscribe=function(t){this._throwIfClosed(),this._trimBuffer();for(var r=this._innerSubscribe(t),s=this,i=s._infiniteTimeWindow,o=s._buffer,a=o.slice(),c=0;c<a.length&&!t.closed;c+=i?1:2)t.next(a[c]);return this._checkFinalizedStatuses(t),r},e.prototype._trimBuffer=function(){var t=this,r=t._bufferSize,s=t._timestampProvider,i=t._buffer,o=t._infiniteTimeWindow,a=(o?1:2)*r;if(r<1/0&&a<i.length&&i.splice(0,i.length-a),!o){for(var c=s.now(),u=0,h=1;h<i.length&&i[h]<=c;h+=2)u=h;u&&i.splice(0,u+1)}},e}(E),cn=function(n){R(e,n);function e(t,r){return n.call(this)||this}return e.prototype.schedule=function(t,r){return this},e}(z),oe={setInterval:function(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];var s=oe.delegate;return s!=null&&s.setInterval?s.setInterval.apply(s,O([n,e],P(t))):setInterval.apply(void 0,O([n,e],P(t)))},clearInterval:function(n){var e=oe.delegate;return((e==null?void 0:e.clearInterval)||clearInterval)(n)},delegate:void 0},un=function(n){R(e,n);function e(t,r){var s=n.call(this,t,r)||this;return s.scheduler=t,s.work=r,s.pending=!1,s}return e.prototype.schedule=function(t,r){var s;if(r===void 0&&(r=0),this.closed)return this;this.state=t;var i=this.id,o=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(o,i,r)),this.pending=!0,this.delay=r,this.id=(s=this.id)!==null&&s!==void 0?s:this.requestAsyncId(o,this.id,r),this},e.prototype.requestAsyncId=function(t,r,s){return s===void 0&&(s=0),oe.setInterval(t.flush.bind(t,this),s)},e.prototype.recycleAsyncId=function(t,r,s){if(s===void 0&&(s=0),s!=null&&this.delay===s&&this.pending===!1)return r;r!=null&&oe.clearInterval(r)},e.prototype.execute=function(t,r){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var s=this._execute(t,r);if(s)return s;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,r){var s=!1,i;try{this.work(t)}catch(o){s=!0,i=o||new Error("Scheduled action threw falsy error")}if(s)return this.unsubscribe(),i},e.prototype.unsubscribe=function(){if(!this.closed){var t=this,r=t.id,s=t.scheduler,i=s.actions;this.work=this.state=this.scheduler=null,this.pending=!1,ie(i,this),r!=null&&(this.id=this.recycleAsyncId(s,r,null)),this.delay=null,n.prototype.unsubscribe.call(this)}},e}(cn),ze=function(){function n(e,t){t===void 0&&(t=n.now),this.schedulerActionCtor=e,this.now=t}return n.prototype.schedule=function(e,t,r){return t===void 0&&(t=0),new this.schedulerActionCtor(this,e).schedule(r,t)},n.now=Ce.now,n}(),hn=function(n){R(e,n);function e(t,r){r===void 0&&(r=ze.now);var s=n.call(this,t,r)||this;return s.actions=[],s._active=!1,s}return e.prototype.flush=function(t){var r=this.actions;if(this._active){r.push(t);return}var s;this._active=!0;do if(s=t.execute(t.state,t.delay))break;while(t=r.shift());if(this._active=!1,s){for(;t=r.shift();)t.unsubscribe();throw s}},e}(ze),Ee=new hn(un),ln=Ee,it=new w(function(n){return n.complete()});function ot(n){return n&&$(n.schedule)}function ke(n){return n[n.length-1]}function at(n){return $(ke(n))?n.pop():void 0}function De(n){return ot(ke(n))?n.pop():void 0}function fn(n,e){return typeof ke(n)=="number"?n.pop():e}var ct=function(n){return n&&typeof n.length=="number"&&typeof n!="function"};function ut(n){return $(n==null?void 0:n.then)}function ht(n){return $(n[_e])}function lt(n){return Symbol.asyncIterator&&$(n==null?void 0:n[Symbol.asyncIterator])}function ft(n){return new TypeError("You provided "+(n!==null&&typeof n=="object"?"an invalid object":"'"+n+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function dn(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var dt=dn();function pt(n){return $(n==null?void 0:n[dt])}function vt(n){return qt(this,arguments,function(){var t,r,s,i;return Qe(this,function(o){switch(o.label){case 0:t=n.getReader(),o.label=1;case 1:o.trys.push([1,,9,10]),o.label=2;case 2:return[4,V(t.read())];case 3:return r=o.sent(),s=r.value,i=r.done,i?[4,V(void 0)]:[3,5];case 4:return[2,o.sent()];case 5:return[4,V(s)];case 6:return[4,o.sent()];case 7:return o.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})}function mt(n){return $(n==null?void 0:n.getReader)}function C(n){if(n instanceof w)return n;if(n!=null){if(ht(n))return pn(n);if(ct(n))return vn(n);if(ut(n))return mn(n);if(lt(n))return yt(n);if(pt(n))return yn(n);if(mt(n))return bn(n)}throw ft(n)}function pn(n){return new w(function(e){var t=n[_e]();if($(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function vn(n){return new w(function(e){for(var t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function mn(n){return new w(function(e){n.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,rt)})}function yn(n){return new w(function(e){var t,r;try{for(var s=G(n),i=s.next();!i.done;i=s.next()){var o=i.value;if(e.next(o),e.closed)return}}catch(a){t={error:a}}finally{try{i&&!i.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}e.complete()})}function yt(n){return new w(function(e){gn(n,e).catch(function(t){return e.error(t)})})}function bn(n){return yt(vt(n))}function gn(n,e){var t,r,s,i;return Ht(this,void 0,void 0,function(){var o,a;return Qe(this,function(c){switch(c.label){case 0:c.trys.push([0,5,6,11]),t=Jt(n),c.label=1;case 1:return[4,t.next()];case 2:if(r=c.sent(),!!r.done)return[3,4];if(o=r.value,e.next(o),e.closed)return[2];c.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=c.sent(),s={error:a},[3,11];case 6:return c.trys.push([6,,9,10]),r&&!r.done&&(i=t.return)?[4,i.call(t)]:[3,8];case 7:c.sent(),c.label=8;case 8:return[3,10];case 9:if(s)throw s.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function F(n,e,t,r,s){r===void 0&&(r=0),s===void 0&&(s=!1);var i=e.schedule(function(){t(),s?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(i),!s)return i}function bt(n,e){return e===void 0&&(e=0),_(function(t,r){t.subscribe(x(r,function(s){return F(r,n,function(){return r.next(s)},e)},function(){return F(r,n,function(){return r.complete()},e)},function(s){return F(r,n,function(){return r.error(s)},e)}))})}function gt(n,e){return e===void 0&&(e=0),_(function(t,r){r.add(n.schedule(function(){return t.subscribe(r)},e))})}function $n(n,e){return C(n).pipe(gt(e),bt(e))}function Sn(n,e){return C(n).pipe(gt(e),bt(e))}function wn(n,e){return new w(function(t){var r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function xn(n,e){return new w(function(t){var r;return F(t,e,function(){r=n[dt](),F(t,e,function(){var s,i,o;try{s=r.next(),i=s.value,o=s.done}catch(a){t.error(a);return}o?t.complete():t.next(i)},0,!0)}),function(){return $(r==null?void 0:r.return)&&r.return()}})}function $t(n,e){if(!n)throw new Error("Iterable cannot be null");return new w(function(t){F(t,e,function(){var r=n[Symbol.asyncIterator]();F(t,e,function(){r.next().then(function(s){s.done?t.complete():t.next(s.value)})},0,!0)})})}function In(n,e){return $t(vt(n),e)}function Tn(n,e){if(n!=null){if(ht(n))return $n(n,e);if(ct(n))return wn(n,e);if(ut(n))return Sn(n,e);if(lt(n))return $t(n,e);if(pt(n))return xn(n,e);if(mt(n))return In(n,e)}throw ft(n)}function ce(n,e){return e?Tn(n,e):C(n)}var Mn=Me(function(n){return function(){n(this),this.name="EmptyError",this.message="no elements in sequence"}});function pe(n,e){var t=typeof e=="object";return new Promise(function(r,s){var i=new N({next:function(o){r(o),i.unsubscribe()},error:s,complete:function(){t?r(e.defaultValue):s(new Mn)}});n.subscribe(i)})}function _n(n){return n instanceof Date&&!isNaN(n)}function v(n,e){return _(function(t,r){var s=0;t.subscribe(x(r,function(i){r.next(n.call(e,i,s++))}))})}var Cn=Array.isArray;function En(n,e){return Cn(e)?n.apply(void 0,O([],P(e))):n(e)}function kn(n){return v(function(e){return En(n,e)})}var Dn=Array.isArray,Ln=Object.getPrototypeOf,Pn=Object.prototype,On=Object.keys;function An(n){if(n.length===1){var e=n[0];if(Dn(e))return{args:e,keys:null};if(Rn(e)){var t=On(e);return{args:t.map(function(r){return e[r]}),keys:t}}}return{args:n,keys:null}}function Rn(n){return n&&typeof n=="object"&&Ln(n)===Pn}function Fn(n,e){return n.reduce(function(t,r,s){return t[r]=e[s],t},{})}function Bn(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=De(n),r=at(n),s=An(n),i=s.args,o=s.keys;if(i.length===0)return ce([],t);var a=new w(jn(i,t,o?function(c){return Fn(o,c)}:B));return r?a.pipe(kn(r)):a}function jn(n,e,t){return t===void 0&&(t=B),function(r){Ke(e,function(){for(var s=n.length,i=new Array(s),o=s,a=s,c=function(h){Ke(e,function(){var l=ce(n[h],e),f=!1;l.subscribe(x(r,function(p){i[h]=p,f||(f=!0,a--),a||r.next(t(i.slice()))},function(){--o||r.complete()}))},r)},u=0;u<s;u++)c(u)},r)}}function Ke(n,e,t){n?F(t,n,e):e()}function Wn(n,e,t,r,s,i,o,a){var c=[],u=0,h=0,l=!1,f=function(){l&&!c.length&&!u&&e.complete()},p=function(d){return u<r?g(d):c.push(d)},g=function(d){i&&e.next(d),u++;var T=!1;C(t(d,h++)).subscribe(x(e,function(k){s==null||s(k),i?p(k):e.next(k)},function(){T=!0},void 0,function(){if(T)try{u--;for(var k=function(){var W=c.shift();o?F(e,o,function(){return g(W)}):g(W)};c.length&&u<r;)k();f()}catch(W){e.error(W)}}))};return n.subscribe(x(e,p,function(){l=!0,f()})),function(){a==null||a()}}function ue(n,e,t){return t===void 0&&(t=1/0),$(e)?ue(function(r,s){return v(function(i,o){return e(r,i,s,o)})(C(n(r,s)))},t):(typeof e=="number"&&(t=e),_(function(r,s){return Wn(r,s,n,t)}))}function St(n){return n===void 0&&(n=1/0),ue(B,n)}function Un(){return St(1)}function Vn(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return Un()(ce(n,De(n)))}function Gn(n){return new w(function(e){C(n()).subscribe(e)})}var Nn={connector:function(){return new E},resetOnDisconnect:!0};function zn(n,e){e===void 0&&(e=Nn);var t=null,r=e.connector,s=e.resetOnDisconnect,i=s===void 0?!0:s,o=r(),a=new w(function(c){return o.subscribe(c)});return a.connect=function(){return(!t||t.closed)&&(t=Gn(function(){return n}).subscribe(o),i&&t.add(function(){return o=r()})),t},a}function he(n,e,t){n===void 0&&(n=0),t===void 0&&(t=ln);var r=-1;return e!=null&&(ot(e)?t=e:r=e),new w(function(s){var i=_n(n)?+n-t.now():n;i<0&&(i=0);var o=0;return t.schedule(function(){s.closed||(s.next(o++),0<=r?this.schedule(void 0,r):s.complete())},i)})}function wt(n,e){return n===void 0&&(n=0),e===void 0&&(e=Ee),n<0&&(n=0),he(n,n,e)}function Kn(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=De(n),r=fn(n,1/0),s=n;return s.length?s.length===1?C(s[0]):St(r)(ce(s,t)):it}function L(n,e){return _(function(t,r){var s=0;t.subscribe(x(r,function(i){return n.call(e,i,s++)&&r.next(i)}))})}function Yn(n,e,t,r,s){return function(i,o){var a=t,c=e,u=0;i.subscribe(x(o,function(h){var l=u++;c=a?n(c,h,l):(a=!0,h),r&&o.next(c)},s&&function(){a&&o.next(c),o.complete()}))}}function y(n){return n<=0?function(){return it}:_(function(e,t){var r=0;e.subscribe(x(t,function(s){++r<=n&&(t.next(s),n<=r&&t.complete())}))})}function Hn(){return _(function(n,e){n.subscribe(x(e,X))})}function qn(n){return v(function(){return n})}function xt(n,e){return e?function(t){return Vn(e.pipe(y(1),Hn()),t.pipe(xt(n)))}:ue(function(t,r){return C(n(t,r)).pipe(y(1),qn(t))})}function Jn(n,e){e===void 0&&(e=Ee);var t=he(n,e);return xt(function(){return t})}function It(n,e){return e===void 0&&(e=B),n=n??Xn,_(function(t,r){var s,i=!0;t.subscribe(x(r,function(o){var a=e(o);(i||!n(s,a))&&(i=!1,s=a,r.next(o))}))})}function Xn(n,e){return n===e}function Zn(n){n===void 0&&(n=1/0);var e;n&&typeof n=="object"?e=n:e={count:n};var t=e.count,r=t===void 0?1/0:t,s=e.delay,i=e.resetOnSuccess,o=i===void 0?!1:i;return r<=0?B:_(function(a,c){var u=0,h,l=function(){var f=!1;h=a.subscribe(x(c,function(p){o&&(u=0),c.next(p)},void 0,function(p){if(u++<r){var g=function(){h?(h.unsubscribe(),h=null,l()):f=!0};if(s!=null){var d=typeof s=="number"?he(s):C(s(p,u)),T=x(c,function(){T.unsubscribe(),g()},function(){c.complete()});d.subscribe(T)}else g()}else c.error(p)})),f&&(h.unsubscribe(),h=null,l())};l()})}function Qn(n,e){return _(Yn(n,e,arguments.length>=2,!0))}function er(n){n===void 0&&(n={});var e=n.connector,t=e===void 0?function(){return new E}:e,r=n.resetOnError,s=r===void 0?!0:r,i=n.resetOnComplete,o=i===void 0?!0:i,a=n.resetOnRefCountZero,c=a===void 0?!0:a;return function(u){var h,l,f,p=0,g=!1,d=!1,T=function(){l==null||l.unsubscribe(),l=void 0},k=function(){T(),h=f=void 0,g=d=!1},W=function(){var K=h;k(),K==null||K.unsubscribe()};return _(function(K,Ve){p++,!d&&!g&&T();var Q=f=f??t();Ve.add(function(){p--,p===0&&!d&&!g&&(l=ve(W,c))}),Q.subscribe(Ve),!h&&p>0&&(h=new N({next:function(ee){return Q.next(ee)},error:function(ee){d=!0,T(),l=ve(k,s,ee),Q.error(ee)},complete:function(){g=!0,T(),l=ve(k,o),Q.complete()}}),C(K).subscribe(h))})(u)}}function ve(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];if(e===!0){n();return}if(e!==!1){var s=new N({next:function(){s.unsubscribe(),n()}});return C(e.apply(void 0,O([],P(t)))).subscribe(s)}}function q(n,e){return _(function(t,r){var s=null,i=0,o=!1,a=function(){return o&&!s&&r.complete()};t.subscribe(x(r,function(c){s==null||s.unsubscribe();var u=0,h=i++;C(n(c,h)).subscribe(s=x(r,function(l){return r.next(e?e(c,l,h,u++):l)},function(){s=null,a()}))},function(){o=!0,a()}))})}function $e(n){return _(function(e,t){C(n).subscribe(x(t,function(){return t.complete()},X)),!t.closed&&e.subscribe(t)})}function Ye(n,e,t){var r=$(n)||e||t?{next:n,error:e,complete:t}:n;return r?_(function(s,i){var o;(o=r.subscribe)===null||o===void 0||o.call(r);var a=!0;s.subscribe(x(i,function(c){var u;(u=r.next)===null||u===void 0||u.call(r,c),i.next(c)},function(){var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),i.complete()},function(c){var u;a=!1,(u=r.error)===null||u===void 0||u.call(r,c),i.error(c)},function(){var c,u;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(u=r.finalize)===null||u===void 0||u.call(r)}))}):B}function Tt(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=at(n);return _(function(r,s){for(var i=n.length,o=new Array(i),a=n.map(function(){return!1}),c=!1,u=function(l){C(n[l]).subscribe(x(s,function(f){o[l]=f,!c&&!a[l]&&(a[l]=!0,(c=a.every(B))&&(a=null))},X))},h=0;h<i;h++)u(h);r.subscribe(x(s,function(l){if(c){var f=O([l],P(o));s.next(t?t.apply(void 0,O([],P(f))):f)}}))})}function S(n,e,t){return n[e]??t}function D(...n){return n.join(".")}const m=n=>tn(v(e=>n(e)),It(),L(e=>e!==void 0)),b=(n,e)=>m(t=>S(t,n,e)),Le=(n,e=0,t,r,s,i=1)=>{switch(s){case"master":{const o=D(t,r-1,n);return a=>S(a,o,e)}case"aux":case"fx":return o=>{const a=D(t,r-1,s,i-1,n);return S(o,a,e)}}},tr=()=>n=>S(n,"m.mix"),nr=()=>n=>S(n,"m.pan"),rr=()=>n=>S(n,"m.dim"),He=n=>e=>S(e,`m.delay${n}`,0)*1e3,sr=(n,e,t,r)=>Le("name",0,n,e,t,r),Mt=(n,e,t,r)=>Le("pan",0,n,e,t,r),ir=(n,e,t,r)=>Le("mute",0,n,e,t,r),or=(n,e)=>{const t=D(n,e-1,"solo");return r=>S(r,t)},ar=(n,e,t,r=1)=>{switch(t){case"master":{const s=D(n,e-1,"mix");return i=>S(i,s)}case"aux":case"fx":{const s=D(n,e-1,t,r-1,"value");return i=>S(i,s)}}},cr=(n,e)=>{const t=D(n,e-1,"delay");return r=>S(r,t,0)*1e3},ur=(n,e,t,r)=>{const s=D(n,e-1,t,r-1,"post");return i=>S(i,s,0)},_t=(n,e)=>{const t=D(n,e-1,"stereoIndex");return r=>["i","l","p","a"].includes(n)?S(r,t,-1):-1},qe=(n,e)=>{const t=D(e,n-1,"phantom");return r=>S(r,t)},Je=(n,e)=>{const t=D(e,n-1,"gain");return r=>S(r,t)},hr=(n,e)=>{const t=D("settings",n,...e!==void 0&&e>=0?[e]:[]);return r=>S(r,t)},Pe=()=>n=>S(n,"var.currentLength",-1),Ct=()=>n=>S(n,"var.currentTrackPos",0),Oe=(n,e)=>Math.max(0,Math.floor(n*e)),Et=(n,e)=>Math.max(0,Math.floor(e-Oe(n,e))),lr=()=>n=>{const e=Ct()(n),t=Pe()(n);return Oe(e,t)},fr=()=>n=>{const e=Ct()(n),t=Pe()(n);return Et(e,t)},Ae=()=>n=>S(n,"var.mtk.currentLength",-1),kt=()=>n=>S(n,"var.mtk.currentTrackPos",0),dr=()=>n=>{const e=kt()(n),t=Ae()(n);return Oe(e,t)},pr=()=>n=>{const e=kt()(n),t=Ae()(n);return Et(e,t)};function I(n,e,t){return Math.min(t,Math.max(e,n))}function Dt(n){return n.match(/^-?\d+$/)?parseInt(n,10):n.match(/^\d+\.\d+$/)?parseFloat(n):n}function vr(n){if(n<0)return"";const e=Math.floor(n),t=Math.floor(e/60),r=e%60;return`${t}:${r.toString().length===1?"0":""}${r}`}function Z(n,e){switch(e){case 1:return n-1;case 0:return n+1;default:return n}}function Xe(n){switch(n){case 1:return"L";case 2:return"R";default:return""}}function Lt(n,e){switch(n){case"i":return"CH "+e;case"a":return"AUX "+e;case"f":return"FX "+e;case"s":return"SUB "+e;case"v":return"VCA "+e;case"l":return"LINE IN "+Xe(e);case"p":return"PLAYER "+Xe(e)}}function mr(n,e){e.conn.sendMessage("SETD^model^"+n)}const Pt=[[-1/0,0],[-100,.00126941502],[-99,.0014193058],[-98,.00158625841],[-97,.00177210569],[-96,.0019787848],[-95,.00220842659],[-94,.00246331096],[-93,.00274592638],[-92,.00305891037],[-91,.00340510905],[-90,.00378751755],[-89,.00420932472],[-88,.00467389822],[-87,.00518476963],[-86,.00574563444],[-85,.00636033714],[-84,.00703287125],[-83,.00776734948],[-82,.00856804848],[-81,.00943937898],[-80,.01038584113],[-79,.01141215861],[-78,.01252317429],[-77,.01372399926],[-76,.01501996815],[-75,.0164167881],[-74,.01792064309],[-73,.01953828335],[-72,.02127727866],[-71,.02314623445],[-70,.02515518665],[-69,.02731607854],[-68,.02964346856],[-67,.03215561062],[-66,.03487607837],[-65,.0378363952],[-64,.04108065367],[-63,.04467409104],[-62,.04872117192],[-61,.05341050774],[-60,.05882352591],[-59,.06435465068],[-58,.06995738298],[-57,.07563393563],[-56,.08138664067],[-55,.08721791208],[-54,.09313031286],[-53,.09912653267],[-52,.10520938411],[-51,.11138185114],[-50,.11764705926],[-49,.12400831282],[-48,.13046910241],[-47,.13703311235],[-46,.14370423928],[-45,.15048661083],[-44,.15738460608],[-43,.16440286487],[-42,.17154632322],[-41,.17882022634],[-40,.18623016588],[-39,.19378209766],[-38,.20148238726],[-37,.20933783613],[-36,.21735573001],[-35,.22554387664],[-34,.23391066305],[-33,.24246510724],[-32,.25121692196],[-31,.26017658552],[-30,.26935542002],[-29.9,.27028582105],[-29.8,.27121854806],[-29.7,.27215361455],[-29.6,.2730910331],[-29.5,.27403081628],[-29.4,.27497297851],[-29.3,.27591753239],[-29.2,.2768644914],[-29.1,.27781386906],[-29,.27876567934],[-28.9,.27971993526],[-28.8,.28067665175],[-28.7,.28163584229],[-28.6,.28259752039],[-28.5,.28356170142],[-28.4,.28452839889],[-28.3,.28549762792],[-28.2,.28646940272],[-28.1,.2874437375],[-28,.28842064831],[-27.9,.28940014914],[-27.8,.29038225533],[-27.7,.29136698227],[-27.6,.29235434486],[-27.5,.29334435938],[-27.4,.29433704074],[-27.3,.29533240478],[-27.2,.2963304678],[-27.1,.29733124515],[-27,.29833475361],[-26.9,.29934100923],[-26.8,.30035002832],[-26.7,.30136182765],[-26.6,.3023764235],[-26.5,.30339383334],[-26.4,.30441407394],[-26.3,.30543716229],[-26.2,.30646311585],[-26.1,.30749195209],[-26,.30852368847],[-25.9,.30955834268],[-25.8,.31059593312],[-25.7,.31163647724],[-25.6,.31267999392],[-25.5,.31372650107],[-25.4,.31477601733],[-25.3,.31582856132],[-25.2,.31688415236],[-25.1,.31794280931],[-25,.31900455104],[-24.9,.32006939733],[-24.8,.32113736775],[-24.7,.32220848184],[-24.6,.32328275964],[-24.5,.32436022116],[-24.4,.32544088666],[-24.3,.32652477687],[-24.2,.32761191227],[-24.1,.32870231359],[-24,.32979600201],[-23.9,.33089299873],[-23.8,.33199332491],[-23.7,.33309700247],[-23.6,.33420405304],[-23.5,.33531449875],[-23.4,.33642836171],[-23.3,.33754566452],[-23.2,.33866642928],[-23.1,.33979067928],[-23,.34091843711],[-22.9,.34204972652],[-22.8,.34318457078],[-22.7,.34432299319],[-22.6,.34546501818],[-22.5,.34661066951],[-22.4,.3477599714],[-22.3,.34891294874],[-22.2,.35006962623],[-22.1,.35123002878],[-22,.35239418154],[-21.9,.35356211034],[-21.8,.35473384033],[-21.7,.35590939806],[-21.6,.35708880937],[-21.5,.35827210057],[-21.4,.35945929866],[-21.3,.36065043067],[-21.2,.36184552335],[-21.1,.36304460443],[-21,.3642477016],[-20.9,.36545484257],[-20.8,.36666605598],[-20.7,.36788136989],[-20.6,.36910081329],[-20.5,.37032441515],[-20.4,.37155220495],[-20.3,.37278421177],[-20.2,.37402046612],[-20.1,.37526099756],[-20,.37650583661],[-19.9,.37775501423],[-19.8,.37900856114],[-19.7,.38026650855],[-19.6,.38152888836],[-19.5,.38279573224],[-19.4,.38406707242],[-19.3,.38534294115],[-19.2,.38662337163],[-19.1,.38790839631],[-19,.3891980492],[-18.9,.3904923636],[-18.8,.39179137361],[-18.7,.39309511357],[-18.6,.39440361829],[-18.5,.39571692259],[-18.4,.39703506161],[-18.3,.39835807122],[-18.2,.39968598739],[-18.1,.40101884631],[-18,.40235668444],[-17.9,.40369953902],[-17.8,.40504744719],[-17.7,.40640044678],[-17.6,.4077585754],[-17.5,.40912187181],[-17.4,.41049037443],[-17.3,.41186412238],[-17.2,.413243155],[-17.1,.41462751222],[-17,.41601723386],[-16.9,.41741236055],[-16.8,.41881293315],[-16.7,.42021899263],[-16.6,.42163058079],[-16.5,.42304773943],[-16.4,.4244705108],[-16.3,.42589893762],[-16.2,.42733306286],[-16.1,.42877293006],[-16,.43021858274],[-15.9,.43167006527],[-15.8,.433127422],[-15.7,.43459069787],[-15.6,.43605993828],[-15.5,.43753518863],[-15.4,.43901649513],[-15.3,.44050390413],[-15.2,.4419974623],[-15.1,.44349721679],[-15,.44500321534],[-14.9,.44651550555],[-14.8,.44803413586],[-14.7,.4495591548],[-14.6,.4510906114],[-14.5,.45262855513],[-14.4,.45417303545],[-14.3,.45572410279],[-14.2,.45728180732],[-14.1,.45884620002],[-14,.46041733201],[-13.9,.46199525474],[-13.8,.46358002012],[-13.7,.46517168032],[-13.6,.46677028784],[-13.5,.46837589552],[-13.4,.46998855658],[-13.3,.47160832456],[-13.2,.47323525313],[-13.1,.47486939642],[-13,.47651080892],[-12.9,.47815954522],[-12.8,.47981566039],[-12.7,.4814792095],[-12.6,.48315024807],[-12.5,.48482883186],[-12.4,.48651501676],[-12.3,.48820885899],[-12.2,.48991041491],[-12.1,.49161974108],[-12,.49333689432],[-11.9,.49506193132],[-11.8,.49679490936],[-11.7,.49853588548],[-11.6,.50028491695],[-11.5,.5020420613],[-11.4,.50380737579],[-11.3,.50558091793],[-11.2,.50736274524],[-11.1,.50915291533],[-11,.51095148548],[-10.9,.51275851321],[-10.8,.51457405591],[-10.7,.51639817073],[-10.6,.51823091484],[-10.5,.52007234516],[-10.4,.52192251827],[-10.3,.52378149075],[-10.2,.52564931882],[-10.1,.52752605826],[-10,.5294117647],[-9.9,.53130649327],[-9.8,.53321029863],[-9.7,.53512323508],[-9.6,.53704535618],[-9.5,.53897671518],[-9.4,.54091736441],[-9.3,.54286735586],[-9.2,.54482674052],[-9.1,.54679556866],[-9,.54877388978],[-8.9,.5507617523],[-8.8,.55275920394],[-8.7,.55476629105],[-8.6,.55678305926],[-8.5,.55880955269],[-8.4,.56084581441],[-8.3,.5628918861],[-8.2,.56494780804],[-8.1,.56701361912],[-8,.56908935658],[-7.9,.57117505604],[-7.8,.57327075163],[-7.7,.57537647523],[-7.6,.57749225723],[-7.5,.5796181258],[-7.4,.58175410703],[-7.3,.58390022506],[-7.2,.58605650149],[-7.1,.58822295559],[-7,.59039960429],[-6.9,.59258646169],[-6.8,.59478353942],[-6.7,.59699084621],[-6.6,.59920838778],[-6.5,.60143616702],[-6.4,.60367418348],[-6.3,.60592243349],[-6.2,.60818091012],[-6.1,.61044960283],[-6,.61272849748],[-5.9,.6150175762],[-5.8,.61731681728],[-5.7,.61962619505],[-5.6,.62194567965],[-5.5,.62427523721],[-5.4,.62661482923],[-5.3,.62896441302],[-5.2,.63132394117],[-5.1,.63369336171],[-5,.63607261766],[-4.9,.63846164738],[-4.8,.64086038404],[-4.7,.64326875575],[-4.6,.6456866854],[-4.5,.64811409055],[-4.4,.65055088326],[-4.3,.65299697022],[-4.2,.65545225237],[-4.1,.6579166252],[-4,.66038997821],[-3.9,.6628721953],[-3.8,.66536315437],[-3.7,.66786272742],[-3.6,.67037078051],[-3.5,.67288717377],[-3.4,.67541176116],[-3.3,.67794439074],[-3.2,.68048490444],[-3.1,.68303313828],[-3,.685588922],[-2.9,.68815207965],[-2.8,.69072242902],[-2.7,.69329978223],[-2.6,.69588394539],[-2.5,.69847471884],[-2.4,.70107189735],[-2.3,.70367526991],[-2.2,.70628462004],[-2.1,.7088997261],[-2,.7115203609],[-1.9,.71414629236],[-1.8,.71677728344],[-1.7,.71941309224],[-1.6,.72205347242],[-1.5,.72469817317],[-1.4,.7273469395],[-1.3,.72999951243],[-1.2,.73265562946],[-1.1,.7353150243],[-1,.73797742761],[-.9,.74064256705],[-.8,.74331016751],[-.7,.7459799514],[-.6,.74865163909],[-.5,.75132494903],[-.4,.75399959798],[-.3,.75667530153],[-.2,.75935177424],[-.1,.76202873001],[0,.76470588235],[.1,.7673829447],[.2,.77005963068],[.3,.77273565461],[.4,.77541073144],[.5,.77808457747],[.6,.78075691027],[.7,.78342744932],[.8,.78609591597],[.9,.788762034],[1,.79142552969],[1.1,.79408613226],[1.2,.79674357391],[1.3,.79939759037],[1.4,.80204792085],[1.5,.80469430843],[1.6,.80733650032],[1.7,.80997424785],[1.8,.81260730696],[1.9,.81523543815],[2,.81785840681],[2.1,.82047598323],[2.2,.82308794296],[2.3,.82569406676],[2.4,.82829414081],[2.5,.83088795675],[2.6,.8334753119],[2.7,.83605600931],[2.8,.83862985772],[2.9,.84119667177],[3,.84375627202],[3.1,.84630848491],[3.2,.84885314284],[3.3,.85139008425],[3.4,.85391915357],[3.5,.85644020114],[3.6,.85895308337],[3.7,.86145766254],[3.8,.86395380691],[3.9,.86644139059],[4,.86892029358],[4.1,.87139040159],[4.2,.87385160607],[4.3,.87630380417],[4.4,.87874689855],[4.5,.8811807974],[4.6,.8836054143],[4.7,.88602066817],[4.8,.88842648314],[4.9,.89082278844],[5,.89320951837],[5.1,.89558661211],[5.2,.89795401365],[5.3,.90031167166],[5.4,.90265953944],[5.5,.9049975747],[5.6,.90732573954],[5.7,.90964400026],[5.8,.91195232733],[5.9,.91425069513],[6,.91653908203],[6.1,.91881747005],[6.2,.92108584497],[6.3,.92334419597],[6.4,.92559251573],[6.5,.92783080021],[6.6,.93005904852],[6.7,.93227726285],[6.8,.93448544835],[6.9,.93668361302],[7,.93887176758],[7.1,.94104992537],[7.2,.9432181023],[7.3,.94537631667],[7.4,.94752458909],[7.5,.94966294241],[7.6,.9517914016],[7.7,.95390999367],[7.8,.95601874754],[7.9,.95811769404],[8,.96020686568],[8.1,.96228629674],[8.2,.96435602299],[8.3,.96641608179],[8.4,.96846651193],[8.5,.97050735351],[8.6,.97253864795],[8.7,.9745604379],[8.8,.9765727671],[8.9,.97857568043],[9,.98056922374],[9.1,.98255344384],[9.2,.98452838843],[9.3,.98649410604],[9.4,.98845064599],[9.5,.99039805829],[9.6,.99233639364],[9.7,.99426570335],[9.8,.9961860393],[9.9,.99809745389],[10,1],[1/0,1]];function Ot(n,e){return I(n,0,e)/1e3}function At(n,e,t,r){for(let s=0;s<n.length;s++)if(!(n[s][t]<e))return s===0||s===1||e===n[s][t]?n[s][r]:n[s-1][r]+(n[s][r]-n[s-1][r])*(e-n[s-1][t])/(n[s][t]-n[s-1][t]);return n[0][r]}function j(n){return At(Pt,n,0,1)}function le(n){const e=At(Pt,n,1,0);return Math.round(e*10)/10}const J=20,Se=4e3;function yr(n){return Math.round((Se-J)*Math.pow(n,3.0517)+J)}function br(n){const e=I(n,J,Se),t=Math.pow((e-J)/(Se-J),.32768620768751844);return Math.floor(t*1e7)/1e7}function we(n,e,t){const r=(n-e)/(t-e);return I(r,0,1)}function xe(n,e,t){const r=Math.round((n*(t-e)+e)*10)/10;return I(r,e,t)}class Ie{constructor(e,t,r){this.conn=e,this.store=t,this.group=r,this.state$=this.store.state$.pipe(b(`automix.${this.group}.on`))}setState(e){this.conn.sendMessage(`SETD^automix.${this.group}.on^${e}`)}enable(){this.setState(1)}disable(){this.setState(0)}toggle(){this.state$.pipe(y(1)).subscribe(e=>this.setState(e^1))}}class Rt{constructor(e,t){this.conn=e,this.store=t,this.responseTime$=this.store.state$.pipe(b("automix.time")),this.responseTimeMs$=this.responseTime$.pipe(v(r=>yr(r))),this.groups={a:new Ie(this.conn,this.store,"a"),b:new Ie(this.conn,this.store,"b")}}setResponseTime(e){this.conn.sendMessage(`SETD^automix.time^${e}`)}setResponseTimeMs(e){this.setResponseTime(br(e))}}var M=(n=>(n.Opening="OPENING",n.Open="OPEN",n.Close="CLOSE",n.Closing="CLOSING",n.Error="ERROR",n.Reconnecting="RECONNECTING",n))(M||{}),Re=(n=>(n[n.Stopped=0]="Stopped",n[n.Playing=2]="Playing",n[n.Paused=3]="Paused",n))(Re||{}),Fe=(n=>(n[n.Stopped=0]="Stopped",n[n.Paused=1]="Paused",n[n.Playing=2]="Playing",n))(Fe||{}),A=(n=>(n[n.Linear=0]="Linear",n[n.EaseIn=1]="EaseIn",n[n.EaseOut=2]="EaseOut",n[n.EaseInOut=3]="EaseInOut",n))(A||{});const Ze={0:n=>n,1:n=>n*n,2:n=>n*(2-n),3:n=>n*(2-n)};function Be(n,e,t){return n.pipe(Tt(e),q(([{targetValue:r,fadeTime:s,easing:i,fps:o},a])=>gr(a,r,s,i,o).pipe($e(t.status$.pipe(L(c=>c.type===M.Close))))))}function gr(n,e,t,r,s){t=Math.max(t,s);const i=Math.round(1e3/s),o=Math.round(t/i);r=r||A.Linear;const a=Ze[r]||Ze[A.Linear];return wt(i).pipe(y(o),v(c=>a((c+1)/o)*(e-n)+n),It())}function je(n){return new Promise(e=>setTimeout(()=>e(),n))}class We{constructor(e,t,r,s,i="master",o=0){this.conn=e,this.store=t,this.channelType=r,this.channel=s,this.busType=i,this.bus=o,this.fullChannelId=`${this.channelType}.${this.channel-1}`,this.faderLevelCommand="mix",this.linkedChannelIds=[],this.transitionSources$=new E,this.stereoIndex$=this.store.state$.pipe(m(_t(this.channelType,this.channel))),this.faderLevel$=this.store.state$.pipe(m(ar(this.channelType,this.channel,this.busType,this.bus))),this.faderLevelDB$=this.faderLevel$.pipe(v(u=>le(u))),this.mute$=this.store.state$.pipe(m(ir(this.channelType,this.channel,this.busType,this.bus))),this.name$=this.store.state$.pipe(m(sr(this.channelType,this.channel,this.busType,this.bus)),v(u=>u||Lt(this.channelType,this.channel)));const a=i+o+r+s,c=this.store.channelStore.get(a);if(c)return c;this.store.channelStore.set(a,this),Be(this.transitionSources$,this.faderLevel$,e).subscribe(u=>this.setFaderLevelRaw(u))}fadeTo(e,t,r=A.Linear,s=25){return e=I(e,0,1),this.transitionSources$.next({targetValue:e,fadeTime:t,easing:r,fps:s}),je(t)}fadeToDB(e,t,r=A.Linear,s=25){const i=j(e);return this.fadeTo(i,t,r,s)}setFaderLevel(e){e=I(e,0,1),this.setFaderLevelRaw(e)}setFaderLevelRaw(e){[...this.linkedChannelIds,this.fullChannelId].forEach(t=>{const r=`SETD^${t}.${this.faderLevelCommand}^${e}`;this.conn.sendMessage(r)})}setFaderLevelDB(e){this.setFaderLevel(j(e))}changeFaderLevelDB(e){this.faderLevelDB$.pipe(y(1)).subscribe(t=>this.setFaderLevelDB(Math.max(t,-100)+e))}setMute(e){[...this.linkedChannelIds,this.fullChannelId].forEach(t=>{const r=`SETD^${t}.mute^${e}`;this.conn.sendMessage(r)})}mute(){this.setMute(1)}unmute(){this.setMute(0)}toggleMute(){this.mute$.pipe(y(1)).subscribe(e=>this.setMute(e^1))}}class Ue extends We{constructor(e,t,r,s,i,o){super(e,t,r,s,i,o),this.fullChannelId=this.constructChannelId(this.channelType,this.channel,this.busType,this.bus),this.faderLevelCommand="value",this.post$=this.store.state$.pipe(m(ur(this.channelType,this.channel,this.busType,this.bus)))}constructChannelId(e,t,r,s){return`${e}.${t-1}.${r}.${s-1}`}setPost(e){[...this.linkedChannelIds,this.fullChannelId].forEach(t=>{const r=`SETD^${t}.post^${e}`;this.conn.sendMessage(r)})}post(){this.setPost(1)}pre(){this.setPost(0)}togglePost(){this.post$.pipe(y(1)).subscribe(e=>this.setPost(e^1))}}class Y extends Ue{constructor(e,t,r,s,i){super(e,t,r,s,"aux",i),this.auxLinkChannelIds=[],this.pan$=this.store.state$.pipe(m(Mt(this.channelType,this.channel,this.busType,this.bus))),Bn([this.store.state$.pipe(m(_t("a",i))),this.stereoIndex$]).pipe(v(([o,a])=>{const c=Z(i,o),u=Z(s,a),h=[],l=[];if(u!==void 0&&h.push(this.constructChannelId(r,u,this.busType,i)),c!==void 0){const f=this.constructChannelId(r,s,this.busType,c);h.push(f),l.push(f)}return c!==void 0&&u!==void 0&&h.push(this.constructChannelId(r,u,this.busType,c)),{allChannelIds:h,auxLinkChannelIds:l}})).subscribe(o=>{this.linkedChannelIds=o.allChannelIds,this.auxLinkChannelIds=o.auxLinkChannelIds})}pan(e){e=I(e,0,1),[...this.auxLinkChannelIds,this.fullChannelId].forEach(t=>{const r=`SETD^${t}.pan^${e}`;this.conn.sendMessage(r)})}setPostProc(e){[...this.linkedChannelIds,this.fullChannelId].forEach(t=>{const r=`SETD^${t}.postproc^${e}`;this.conn.sendMessage(r)})}postProc(){this.setPostProc(1)}preProc(){this.setPostProc(0)}}class Ft{constructor(e,t,r){this.conn=e,this.store=t,this.bus=r}input(e){return new Y(this.conn,this.store,"i",e,this.bus)}line(e){return new Y(this.conn,this.store,"l",e,this.bus)}player(e){return new Y(this.conn,this.store,"p",e,this.bus)}fx(e){return new Y(this.conn,this.store,"f",e,this.bus)}}class Bt{constructor(e){this.store=e,this.model$=this.store.state$.pipe(b("model")),this.firmware$=this.store.state$.pipe(b("firmware")),this.model$.subscribe(t=>this.model=t)}}class jt{constructor(e,t){this.conn=e,this.store=t,this.recording$=this.store.state$.pipe(b("var.isRecording",0)),this.busy$=this.store.state$.pipe(b("var.recBusy",0))}recordToggle(){this.conn.sendMessage("RECTOGGLE")}}class H extends Ue{constructor(e,t,r,s,i){super(e,t,r,s,"fx",i),this.stereoIndex$.pipe(v(o=>{const a=Z(s,o);return a!==void 0?[this.constructChannelId(this.channelType,a,this.busType,this.bus)]:[]})).subscribe(o=>this.linkedChannelIds=o)}}class Wt{constructor(e,t,r){this.conn=e,this.store=t,this.bus=r}input(e){return new H(this.conn,this.store,"i",e,this.bus)}line(e){return new H(this.conn,this.store,"l",e,this.bus)}player(e){return new H(this.conn,this.store,"p",e,this.bus)}sub(e){return new H(this.conn,this.store,"s",e,this.bus)}}class Ut{constructor(e,t,r,s){this.conn=e,this.store=t,this.deviceInfo=r,this.channel=s,this.fullChannelId=`hw.${this.channel-1}`,this.phantom$=this.deviceInfo.model$.pipe(q(a=>{switch(a){case"ui24":return this.store.state$.pipe(m(qe(this.channel,"hw")));case"ui16":case"ui12":return this.store.state$.pipe(m(qe(this.channel,"i")))}})),this.gain$=this.deviceInfo.model$.pipe(q(a=>{switch(a){case"ui24":return this.store.state$.pipe(m(Je(this.channel,"hw")));case"ui16":case"ui12":return this.store.state$.pipe(m(Je(this.channel,"i")))}})),this.gainDB$=this.deviceInfo.model$.pipe(q(a=>{switch(a){case"ui24":return this.gain$.pipe(v(c=>xe(c,-6,57)));case"ui16":case"ui12":return this.gain$.pipe(v(c=>xe(c,-40,50)))}}));const i="hw"+s,o=this.store.channelStore.get(i);if(o)return o;this.store.channelStore.set(i,this),this.deviceInfo.model$.subscribe(a=>{switch(a){case"ui24":this.fullChannelId=`hw.${this.channel-1}`;return;case"ui16":case"ui12":this.fullChannelId=`i.${this.channel-1}`;return}})}setPhantom(e){const t=`SETD^${this.fullChannelId}.phantom^${e}`;this.conn.sendMessage(t)}phantomOn(){this.setPhantom(1)}phantomOff(){this.setPhantom(0)}togglePhantom(){this.phantom$.pipe(y(1)).subscribe(e=>this.setPhantom(e^1))}setGain(e){e=I(e,0,1);const t=`SETD^${this.fullChannelId}.gain^${e}`;this.conn.sendMessage(t)}setGainDB(e){switch(this.deviceInfo.model){case"ui24":this.setGain(we(e,-6,57));return;case"ui16":case"ui12":this.setGain(we(e,-40,50));return}}changeGainDB(e){this.gainDB$.pipe(y(1)).subscribe(t=>this.setGainDB(t+e))}}class U extends We{constructor(e,t,r,s){super(e,t,r,s),this.fullChannelId=this.constructChannelId(this.channelType,this.channel),this.faderLevelCommand="mix",this.solo$=this.store.state$.pipe(m(or(this.channelType,this.channel))),this.pan$=this.store.state$.pipe(m(Mt(this.channelType,this.channel,this.busType,this.bus))),this.automixGroup$=this.store.state$.pipe(b(`${this.fullChannelId}.amixgroup`),v(i=>{switch(i){case 0:return"a";case 1:return"b";default:return"none"}})),this.automixWeight$=this.store.state$.pipe(b(`${this.fullChannelId}.amix`)),this.automixWeightDB$=this.automixWeight$.pipe(v(i=>xe(i,-12,12))),this.stereoIndex$.pipe(v(i=>{const o=Z(s,i);return o!==void 0?[this.constructChannelId(this.channelType,o)]:[]})).subscribe(i=>this.linkedChannelIds=i)}constructChannelId(e,t){return`${e}.${t-1}`}pan(e){e=I(e,0,1);const t=`SETD^${this.fullChannelId}.pan^${e}`;this.conn.sendMessage(t)}setSolo(e){[...this.linkedChannelIds,this.fullChannelId].forEach(t=>{const r=`SETD^${t}.solo^${e}`;this.conn.sendMessage(r)})}solo(){this.setSolo(1)}unsolo(){this.setSolo(0)}toggleSolo(){this.solo$.pipe(y(1)).subscribe(e=>this.setSolo(e^1))}automixAssignGroup(e){if(this.channelType!=="i")throw new Error("Automix can only be used with input channels");let t=-1;switch(e){case"a":t=0;break;case"b":t=1;break;case"none":t=-1;break}[...this.linkedChannelIds,this.fullChannelId].forEach(r=>{const s=`SETD^${r}.amixgroup^${t}`;this.conn.sendMessage(s)})}automixRemove(){this.automixAssignGroup("none")}automixSetWeight(e){e=I(e,0,1),[...this.linkedChannelIds,this.fullChannelId].forEach(t=>{const r=`SETD^${t}.amix^${e}`;this.conn.sendMessage(r)})}automixSetWeightDB(e){this.automixSetWeight(we(e,-12,12))}automixChangeWeightDB(e){this.automixWeightDB$.pipe(y(1)).subscribe(t=>this.automixSetWeightDB(t+e))}}class se extends U{constructor(e,t,r,s){super(e,t,r,s),this.delay$=this.store.state$.pipe(m(cr(this.channelType,this.channel))),this.delayMaxValueMs=250,r==="a"&&(this.delayMaxValueMs=500)}setDelay(e){const t=Ot(e,this.delayMaxValueMs),r=`SETD^${this.fullChannelId}.delay^${t}`;this.conn.sendMessage(r)}changeDelay(e){this.delay$.pipe(y(1)).subscribe(t=>this.setDelay(t+e))}}class Vt{constructor(e,t){this.conn=e,this.store=t,this.faderLevel$=this.store.state$.pipe(m(tr())),this.faderLevelDB$=this.faderLevel$.pipe(v(r=>le(r))),this.pan$=this.store.state$.pipe(m(nr())),this.dim$=this.store.state$.pipe(m(rr())),this.delayL$=this.store.state$.pipe(m(He("L"))),this.delayR$=this.store.state$.pipe(m(He("R"))),this.transitionSources$=new E,Be(this.transitionSources$,this.faderLevel$,e).subscribe(r=>this.setFaderLevelRaw(r))}input(e){return new se(this.conn,this.store,"i",e)}line(e){return new se(this.conn,this.store,"l",e)}player(e){return new U(this.conn,this.store,"p",e)}aux(e){return new se(this.conn,this.store,"a",e)}fx(e){return new U(this.conn,this.store,"f",e)}sub(e){return new U(this.conn,this.store,"s",e)}vca(e){return new U(this.conn,this.store,"v",e)}fadeTo(e,t,r=A.Linear,s=25){return e=I(e,0,1),this.transitionSources$.next({targetValue:e,fadeTime:t,easing:r,fps:s}),je(t)}fadeToDB(e,t,r=A.Linear,s=25){const i=j(e);return this.fadeTo(i,t,r,s)}setFaderLevel(e){e=I(e,0,1),this.setFaderLevelRaw(e)}setFaderLevelRaw(e){const t=`SETD^m.mix^${e}`;this.conn.sendMessage(t)}setFaderLevelDB(e){this.setFaderLevel(j(e))}changeFaderLevelDB(e){this.faderLevelDB$.pipe(y(1)).subscribe(t=>this.setFaderLevelDB(Math.max(t,-100)+e))}pan(e){e=I(e,0,1);const t=`SETD^m.pan^${e}`;this.conn.sendMessage(t)}setDim(e){const t=`SETD^m.dim^${e}`;this.conn.sendMessage(t)}dim(){this.setDim(1)}undim(){this.setDim(0)}toggleDim(){this.dim$.pipe(y(1)).subscribe(e=>this.setDim(e^1))}setDelayL(e){this.setDelay(e,"L")}setDelayR(e){this.setDelay(e,"R")}changeDelayL(e){this.delayL$.pipe(y(1)).subscribe(t=>this.setDelayL(t+e))}changeDelayR(e){this.delayR$.pipe(y(1)).subscribe(t=>this.setDelayR(t+e))}setDelay(e,t){const r=Ot(e,500);this.conn.sendMessage(`SETD^m.delay${t}^${r}`)}}class Gt{constructor(e,t){this.conn=e,this.store=t,this.state$=this.store.state$.pipe(b("var.mtk.currentState",Fe.Stopped)),this.session$=this.store.state$.pipe(b("var.mtk.session"),v(r=>typeof r=="number"?r.toString().padStart(4,"0"):r)),this.length$=this.store.state$.pipe(m(Ae())),this.elapsedTime$=this.store.state$.pipe(m(dr())),this.remainingTime$=this.store.state$.pipe(m(pr())),this.recording$=this.store.state$.pipe(b("var.mtk.rec.currentState",0)),this.busy$=this.store.state$.pipe(b("var.mtk.rec.busy",0)),this.recordingTime$=this.store.state$.pipe(b("var.mtk.rec.time",0),Tt(this.recording$),v(([r,s])=>s?r:0)),this.soundcheck$=this.store.state$.pipe(b("var.mtk.soundcheck",0))}play(){this.conn.sendMessage("MTK_PLAY")}pause(){this.conn.sendMessage("MTK_PAUSE")}stop(){this.conn.sendMessage("MTK_STOP")}recordToggle(){this.conn.sendMessage("MTK_REC_TOGGLE")}setSoundcheck(e){const t=`SETD^var.mtk.soundcheck^${e}`;this.conn.sendMessage(t)}activateSoundcheck(){this.setSoundcheck(1)}deactivateSoundcheck(){this.setSoundcheck(0)}toggleSoundcheck(){this.soundcheck$.pipe(y(1)).subscribe(e=>this.setSoundcheck(e^1))}}function $r(n,e){return e<0?n:n^1<<e}function Sr(n,e){return e<0?n:n&~(1<<e)}function wr(n,e){return e<0?n:n|1<<e}function xr(n,e){return e<0?n:n&1<<e?1:0}function Ir(n){switch(n){case"all":return 23;case"fx":return 22;default:return n-1}}class Nt{constructor(e,t,r){this.conn=e,this.store=t,this.id=r,this.mgMask$=this.store.state$.pipe(b("mgmask")),this.state$=this.mgMask$.pipe(v(o=>xr(o,this.groupIndex))),this.groupIndex=Ir(r);const s="mutegroup"+r,i=this.store.channelStore.get(s);if(i)return i;this.store.channelStore.set(s,this)}mute(){this.mgMask$.pipe(y(1)).subscribe(e=>this.setMgMask(wr(e,this.groupIndex)))}unmute(){this.mgMask$.pipe(y(1)).subscribe(e=>this.setMgMask(Sr(e,this.groupIndex)))}toggle(){this.mgMask$.pipe(y(1)).subscribe(e=>this.setMgMask($r(e,this.groupIndex)))}setMgMask(e){const t=`SETD^mgmask^${e}`;this.conn.sendMessage(t)}}class zt{constructor(e,t){this.conn=e,this.store=t,this.state$=this.store.state$.pipe(b("var.currentState",Re.Stopped)),this.playlist$=this.store.state$.pipe(b("var.currentPlaylist")),this.track$=this.store.state$.pipe(b("var.currentTrack")),this.length$=this.store.state$.pipe(m(Pe())),this.elapsedTime$=this.store.state$.pipe(m(lr())),this.remainingTime$=this.store.state$.pipe(m(fr())),this.shuffle$=this.store.state$.pipe(b("settings.shuffle",0))}play(){this.conn.sendMessage("MEDIA_PLAY")}pause(){this.conn.sendMessage("MEDIA_PAUSE")}stop(){this.conn.sendMessage("MEDIA_STOP")}next(){this.conn.sendMessage("MEDIA_NEXT")}prev(){this.conn.sendMessage("MEDIA_PREV")}loadPlaylist(e){this.conn.sendMessage(`MEDIA_SWITCH_PLIST^${e}`)}loadTrack(e,t){this.conn.sendMessage(`MEDIA_SWITCH_TRACK^${e}^${t}`)}setShuffle(e){this.conn.sendMessage(`SETD^settings.shuffle^${e}`)}toggleShuffle(){this.shuffle$.pipe(y(1)).subscribe(e=>this.setShuffle(e^1))}setPlayMode(e){this.conn.sendMessage(`SETD^settings.playMode^${e}`)}setManual(){this.setPlayMode(0)}setAuto(){this.setPlayMode(3)}}class Kt{constructor(e,t){this.conn=e,this.store=t,this.currentShow$=this.store.state$.pipe(b("var.currentShow")),this.currentSnapshot$=this.store.state$.pipe(b("var.currentSnapshot")),this.currentCue$=this.store.state$.pipe(b("var.currentCue"))}loadShow(e){this.conn.sendMessage(`LOADSHOW^${e}`)}loadSnapshot(e,t){this.conn.sendMessage(`LOADSNAPSHOT^${e}^${t}`)}loadCue(e,t){this.conn.sendMessage(`LOADCUE^${e}^${t}`)}}class Te{constructor(e,t,r,s){this.conn=e,this.store=t,this.busName=r,this.busId=s,this.transitionSources$=new E,this.faderLevel$=this.store.state$.pipe(m(hr(this.busName,this.busId?this.busId-1:void 0))),this.faderLevelDB$=this.faderLevel$.pipe(v(a=>le(a)));const i="volume-"+this.busName+this.busId,o=this.store.channelStore.get(i);if(o)return o;this.store.channelStore.set(i,this),Be(this.transitionSources$,this.faderLevel$,e).subscribe(a=>this.setFaderLevelRaw(a))}fadeTo(e,t,r=A.Linear,s=25){return e=I(e,0,1),this.transitionSources$.next({targetValue:e,fadeTime:t,easing:r,fps:s}),je(t)}fadeToDB(e,t,r=A.Linear,s=25){const i=j(e);return this.fadeTo(i,t,r,s)}setFaderLevel(e){e=I(e,0,1),this.setFaderLevelRaw(e)}setFaderLevelRaw(e){const r=`SETD^settings.${`${this.busName}${this.busId?"."+(this.busId-1):""}`}^${e}`;this.conn.sendMessage(r)}setFaderLevelDB(e){this.setFaderLevel(j(e))}changeFaderLevelDB(e){this.faderLevelDB$.pipe(y(1)).subscribe(t=>this.setFaderLevelDB(Math.max(t,-100)+e))}}var Tr={url:"",deserializer:function(n){return JSON.parse(n.data)},serializer:function(n){return JSON.stringify(n)}},Mr="WebSocketSubject.error must be called with an object with an error code, and an optional reason: { code: number, reason: string }",_r=function(n){R(e,n);function e(t,r){var s=n.call(this)||this;if(s._socket=null,t instanceof w)s.destination=r,s.source=t;else{var i=s._config=ye({},Tr);if(s._output=new E,typeof t=="string")i.url=t;else for(var o in t)t.hasOwnProperty(o)&&(i[o]=t[o]);if(!i.WebSocketCtor&&WebSocket)i.WebSocketCtor=WebSocket;else if(!i.WebSocketCtor)throw new Error("no WebSocket constructor can be found");s.destination=new re}return s}return e.prototype.lift=function(t){var r=new e(this._config,this.destination);return r.operator=t,r.source=this,r},e.prototype._resetState=function(){this._socket=null,this.source||(this.destination=new re),this._output=new E},e.prototype.multiplex=function(t,r,s){var i=this;return new w(function(o){try{i.next(t())}catch(c){o.error(c)}var a=i.subscribe({next:function(c){try{s(c)&&o.next(c)}catch(u){o.error(u)}},error:function(c){return o.error(c)},complete:function(){return o.complete()}});return function(){try{i.next(r())}catch(c){o.error(c)}a.unsubscribe()}})},e.prototype._connectSocket=function(){var t=this,r=this._config,s=r.WebSocketCtor,i=r.protocol,o=r.url,a=r.binaryType,c=this._output,u=null;try{u=i?new s(o,i):new s(o),this._socket=u,a&&(this._socket.binaryType=a)}catch(l){c.error(l);return}var h=new z(function(){t._socket=null,u&&u.readyState===1&&u.close()});u.onopen=function(l){var f=t._socket;if(!f){u.close(),t._resetState();return}var p=t._config.openObserver;p&&p.next(l);var g=t.destination;t.destination=ae.create(function(d){if(u.readyState===1)try{var T=t._config.serializer;u.send(T(d))}catch(k){t.destination.error(k)}},function(d){var T=t._config.closingObserver;T&&T.next(void 0),d&&d.code?u.close(d.code,d.reason):c.error(new TypeError(Mr)),t._resetState()},function(){var d=t._config.closingObserver;d&&d.next(void 0),u.close(),t._resetState()}),g&&g instanceof re&&h.add(g.subscribe(t.destination))},u.onerror=function(l){t._resetState(),c.error(l)},u.onclose=function(l){u===t._socket&&t._resetState();var f=t._config.closeObserver;f&&f.next(l),l.wasClean?c.complete():c.error(l)},u.onmessage=function(l){try{var f=t._config.deserializer;c.next(f(l))}catch(p){c.error(p)}}},e.prototype._subscribe=function(t){var r=this,s=this.source;return s?s.subscribe(t):(this._socket||this._connectSocket(),this._output.subscribe(t),t.add(function(){var i=r._socket;r._output.observers.length===0&&(i&&(i.readyState===1||i.readyState===0)&&i.close(),r._resetState())}),t)},e.prototype.unsubscribe=function(){var t=this._socket;t&&(t.readyState===1||t.readyState===0)&&t.close(),this._resetState(),n.prototype.unsubscribe.call(this)},e}(ge);function Cr(n){return new _r(n)}class Er{constructor(e){this.targetIP=e,this.reconnectTime=2e3,this.keepaliveTime=1e3,this.forceClose$=new E,this.statusSubject$=new E,this.outboundSubject$=new E,this.inboundSubject$=new E,this.status$=this.statusSubject$.asObservable(),this.outbound$=this.outboundSubject$.asObservable(),this.inbound$=this.inboundSubject$.asObservable(),this.allMessages$=Kn(this.outbound$,this.inbound$),this.socket$=Cr({url:`ws://${this.targetIP}`,WebSocketCtor:Yt,serializer:s=>s,deserializer:({data:s})=>s,openObserver:{next:()=>this.statusSubject$.next({type:M.Open})},closingObserver:{next:()=>this.statusSubject$.next({type:M.Closing})},closeObserver:{next:()=>this.statusSubject$.next({type:M.Close})}});const t=this.status$.pipe(L(s=>s.type===M.Open)),r=this.status$.pipe(L(s=>s.type===M.Close));t.pipe(q(()=>wt(this.keepaliveTime).pipe($e(r))),v(()=>"ALIVE")).subscribe(s=>this.outboundSubject$.next(s)),this.outbound$.pipe(v(s=>`3:::${s}`)).subscribe(this.socket$)}connect(){return this.statusSubject$.next({type:M.Opening}),this.socket$.pipe(Ye({error:t=>this.statusSubject$.next({type:M.Error,payload:t})}),Zn({delay:()=>he(this.reconnectTime).pipe($e(this.forceClose$),Ye(()=>this.statusSubject$.next({type:M.Reconnecting})))}),v(t=>{const r=t.match(/^(3:::)([\s\S]*)/);return r&&r[2]}),L(t=>!!t),ue(t=>t.split(`
`))).subscribe(t=>this.inboundSubject$.next(t)),pe(this.status$.pipe(L(t=>t.type===M.Open),v(()=>{})))}disconnect(){return this.socket$.complete(),this.forceClose$.next(),pe(this.status$.pipe(L(e=>e.type===M.Close),v(()=>{})))}reconnect(){return this.status$.pipe(L(e=>e.type===M.Close),y(1),Jn(1e3)).subscribe(()=>this.connect()),this.disconnect(),pe(this.status$.pipe(L(e=>e.type===M.Open),v(()=>{})))}sendMessage(e){this.outboundSubject$.next(e)}}class kr{constructor(){this.store=new Map}get(e){return this.store.get(e)}set(e,t){this.store.set(e,t)}}class Dr{constructor(e){this.conn=e,this.setdSetsMessageMatches$=this.conn.allMessages$.pipe(v(t=>t.match(/(SETD|SETS)\^([a-zA-Z0-9.]+)\^(.*)/)),L(t=>!!t),er()),this.messages$=this.setdSetsMessageMatches$.pipe(v(([t])=>t)),this.state$=zn(this.setdSetsMessageMatches$.pipe(Qn((t,[,,r,s])=>(t[r]=Dt(s),t),{})),{connector:()=>new re(1)}),this.channelStore=new kr,this.state$.connect()}}class Lr{constructor(e){this.targetIP=e,this.conn=new Er(this.targetIP),this.store=new Dr(this.conn),this.deviceInfo=new Bt(this.store),this.status$=this.conn.status$,this.master=new Vt(this.conn,this.store),this.player=new zt(this.conn,this.store),this.recorderDualTrack=new jt(this.conn,this.store),this.recorderMultiTrack=new Gt(this.conn,this.store),this.volume={solo:new Te(this.conn,this.store,"solovol"),headphone:t=>new Te(this.conn,this.store,"hpvol",t)},this.shows=new Kt(this.conn,this.store),this.automix=new Rt(this.conn,this.store)}aux(e){return new Ft(this.conn,this.store,e)}fx(e){return new Wt(this.conn,this.store,e)}muteGroup(e){return new Nt(this.conn,this.store,e)}clearMuteGroups(){this.conn.sendMessage("SETD^mgmask^0")}hw(e){return new Ut(this.conn,this.store,this.deviceInfo,e)}connect(){return this.conn.connect()}disconnect(){return this.conn.disconnect()}reconnect(){return this.conn.reconnect()}}exports.AutomixController=Rt;exports.AutomixGroup=Ie;exports.AuxBus=Ft;exports.AuxChannel=Y;exports.Channel=We;exports.ConnectionStatus=M;exports.DBToFaderValue=j;exports.DelayableMasterChannel=se;exports.DeviceInfo=Bt;exports.DualTrackRecorder=jt;exports.Easings=A;exports.FxBus=Wt;exports.FxChannel=H;exports.HwChannel=Ut;exports.MasterBus=Vt;exports.MasterChannel=U;exports.MtkState=Fe;exports.MultiTrackRecorder=Gt;exports.MuteGroup=Nt;exports.Player=zt;exports.PlayerState=Re;exports.SendChannel=Ue;exports.ShowController=Kt;exports.SoundcraftUI=Lr;exports.VolumeBus=Te;exports.clamp=I;exports.constructReadableChannelName=Lt;exports.faderValueToDB=le;exports.getLinkedChannelNumber=Z;exports.playerTimeToString=vr;exports.setMixerModel=mr;exports.transformStringValue=Dt;
